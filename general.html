<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dashboard Cleaner</title>

<style>
body{
  font-family:Segoe UI,Arial;
  background:#f4f6f8;
  margin:0;
  padding:16px
}
.card{
  background:#fff;
  border-radius:16px;
  padding:20px;
  max-width:900px;
  margin:auto;
  box-shadow:0 6px 14px rgba(0,0,0,.1)
}
.header{
  display:flex;
  justify-content:space-between;
  align-items:center
}
select,input{
  width:100%;
  padding:10px;
  border-radius:10px;
  border:1px solid #ccc;
  margin-top:6px
}
button{
  padding:14px;
  width:100%;
  border:none;
  border-radius:14px;
  font-size:15px;
  margin-top:16px;
  background:#4CAF50;
  color:#fff
}

/* ===== DESKTOP TABLE ===== */
table{
  width:100%;
  border-collapse:collapse;
  margin-top:16px
}
th,td{
  border:1px solid #ddd;
  padding:10px;
  font-size:14px
}
th{background:#f0f0f0}

/* ===== MOBILE MODE ===== */
@media(max-width:768px){
  table,thead{display:none}
  .task-card{
    border:1px solid #ddd;
    border-radius:14px;
    padding:12px;
    margin-top:12px
  }
  .task-card b{display:block;margin-bottom:6px}
}
</style>
</head>

<body>

<div class="card">
  <div class="header">
    <div>
      <strong id="userName"></strong><br>
      <small>Daily Task Cleaner</small>
    </div>
  </div>

  <br>

  <label>Lokasi Kerja</label>
  <select id="lokasi" onchange="renderTask()">
    <option value="">-- Pilih Lokasi --</option>
    <option value="MTHS">MTH Square (HO)</option>
    <option value="BIZPARK">Bizpark 3</option>
  </select>

  <label>Tanggal</label>
  <input type="date" id="tanggal">

  <table>
    <thead>
      <tr>
        <th>Area</th>
        <th>Task</th>
        <th>Status</th>
        <th>Keterangan</th>
      </tr>
    </thead>
    <tbody id="taskBody"></tbody>
  </table>

  <div id="mobileTask"></div>

  <button onclick="simpan()">Simpan</button>
</div>

<script>
const SCRIPT_URL='https://script.google.com/macros/s/AKfycby7ziY9k2Frrmnp-YNRbPDVtppIb7UE3m5Ww6iEdRkeKdw5S7k-rGQrivZxhVQbXxXs/exec';

const user=localStorage.getItem('cleaner_name');
if(!user) location.href='login.html';
document.getElementById('userName').innerText=user;

const taskByLocation={
 MTHS:[
    {area:'Area Kerja',task:'Sapu & Pel Lantai'},
    {area:'Area Kerja',task:'Vacum Karpet Lantai'},
    {area:'Area Kerja',task:'Lap Pintu Kaca'},
    {area:'Area Kerja',task:'Menyalakan Lampu,AC,dan Air Purifier'},
    {area:'Area Kerja',task:'Bersihkan meja,kursi lemari area kerja'},
    {area:'Area Kerja',task:'Lap Pintu Kaca'},
    {area:'Area Kerja',task:'Menyiapkan minum untuk BoD'},
    {area:'Area Kerja',task:'Koordinasi menjadi PIC Receptionist'},
    {area:'Area Kerja',task:'Membersihkan tempat sampah di Area Kerja'},
    {area:'Pantry',task:'Buang Sampah ke TPS'},
    {area:'Pantry',task:'Pembersihan alat makan dan wastafel cek saluran pembuangan'},
    {area:'Pantry',task:'Koordinasi menjadi PIC Receptionist'},
    {area:'Pantry',task:'Lap Kulkas dan Pembersihan secara berkala'}
   
  ],
  BIZPARK:[
    {area:'Gudang B05/C01',task:'Sapu & Pel Lantai Area Gudang'},
    {area:'Gudang B05/C01',task:'Sapu Halaman Depan C01/B05'},
    {area:'Gudang B05/C01',task:'Pembersihan Besi Racking dan Dus Produk'},
    {area:'Gudang B05/C01',task:'Pembersihan sarang2 di langit2 gudang'},
    {area:'Gudang B05/C01',task:'Menyiram tanaman halaman'},
    {area:'Gudang B05/C01',task:'Memastikan bersih sampah di area gudang'},
    {area:'Office',task:'Sapu & Pel Lantai'},
    {area:'Office',task:'Bersihkan meja R meeting dan meja kerja lain nya'},
    {area:'Pantry',task:'Sapu Pel Lantai'},
    {area:'Pantry',task:'Pembersihan alat makan dan wastafel'},
    {area:'Pantry',task:'Memastikan bersih sampah di area Pantry dan Office'}
  ]
};

const tbody=document.getElementById('taskBody');
const mobile=document.getElementById('mobileTask');

function renderTask(){
  const lokasi=document.getElementById('lokasi').value;
  tbody.innerHTML='';
  mobile.innerHTML='';
  if(!lokasi) return;

  taskByLocation[lokasi].forEach((t,i)=>{
    tbody.innerHTML+=`
      <tr>
        <td>${t.area}</td>
        <td>${t.task}</td>
        <td><input type="checkbox" id="ck${i}"></td>
        <td><input id="nt${i}"></td>
      </tr>`;

    mobile.innerHTML+=`
      <div class="task-card">
        <b>${t.area}</b>
        ${t.task}<br><br>
        <label>
          <input type="checkbox" id="mck${i}"> Selesai
        </label>
        <input id="mnt${i}" placeholder="Catatan">
      </div>`;
  });
}

function simpan(){
  const lokasi=document.getElementById('lokasi').value;
  const tanggal=document.getElementById('tanggal').value;
  if(!lokasi||!tanggal){
    alert('Lokasi & tanggal wajib diisi');
    return;
  }

  const detail=[];
  taskByLocation[lokasi].forEach((t,i)=>{
    const ck=document.getElementById('ck'+i)||document.getElementById('mck'+i);
    const nt=document.getElementById('nt'+i)||document.getElementById('mnt'+i);
    detail.push({
      area:t.area,
      task:t.task,
      status:ck.checked?'SELESAI':'BELUM',
      catatan:nt.value
    });
  });

  fetch(SCRIPT_URL,{
    method:'POST',
    body:JSON.stringify({
      nama:user,
      lokasi,
      tanggal,
      detail
    })
  }).then(()=>{
    alert('Data tersimpan ke Google Sheet');
    location.reload();
  });
}
</script>

</body>
</html>
